<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WaaS Research Board</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.6/Sortable.min.js"></script>
</head>

<body>
    <!-- Header -->
    <header class="board-header">
        <div class="header-left">
            <svg class="logo-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="7" height="9" rx="1" />
                <rect x="14" y="3" width="7" height="5" rx="1" />
                <rect x="3" y="16" width="7" height="5" rx="1" />
                <rect x="14" y="12" width="7" height="9" rx="1" />
            </svg>
            <h1 class="board-title">WaaS Research Board</h1>
        </div>
        <div class="header-right">
            <button class="btn-header" id="settingsBtn" title="Settings">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                    <circle cx="12" cy="12" r="3"/>
                    <path d="M12 1v4m0 14v4M4.22 4.22l2.83 2.83m9.9 9.9l2.83 2.83M1 12h4m14 0h4M4.22 19.78l2.83-2.83m9.9-9.9l2.83-2.83"/>
                </svg>
            </button>
            <button class="btn-header" id="addColumnBtn" title="Add Column">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                    <line x1="12" y1="5" x2="12" y2="19" />
                    <line x1="5" y1="12" x2="19" y2="12" />
                </svg>
                Add List
            </button>
        </div>
    </header>

    <!-- Board -->
    <main class="board" id="board">
        <!-- Columns render here dynamically -->
    </main>

    <!-- Card Detail Modal -->
    <div class="modal-overlay" id="modalOverlay">
        <div class="modal" id="cardModal">
            <button class="modal-close" id="modalClose">&times;</button>
            <div class="modal-header">
                <svg class="modal-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    width="20" height="20">
                    <rect x="3" y="3" width="18" height="18" rx="2" />
                    <line x1="9" y1="3" x2="9" y2="21" />
                </svg>
                <input type="text" class="modal-title-input" id="modalTitle" placeholder="Card title...">
            </div>
            <div class="modal-meta">
                <span class="modal-meta-item" id="modalColumn"></span>
                <span class="modal-meta-item" id="modalCreated"></span>
            </div>
            <div class="modal-labels" id="modalLabels">
                <span class="label-title">Labels:</span>
                <div class="label-chips" id="labelChips"></div>
                <button class="btn-add-label" id="addLabelBtn" title="Add Label">+</button>
            </div>
            <div class="label-picker" id="labelPicker" style="display:none;">
                <div class="label-color" data-color="#61bd4f" style="background:#61bd4f;"></div>
                <div class="label-color" data-color="#f2d600" style="background:#f2d600;"></div>
                <div class="label-color" data-color="#ff9f1a" style="background:#ff9f1a;"></div>
                <div class="label-color" data-color="#eb5a46" style="background:#eb5a46;"></div>
                <div class="label-color" data-color="#c377e0" style="background:#c377e0;"></div>
                <div class="label-color" data-color="#0079bf" style="background:#0079bf;"></div>
                <div class="label-color" data-color="#00c2e0" style="background:#00c2e0;"></div>
                <div class="label-color" data-color="#51e898" style="background:#51e898;"></div>
                <div class="label-color" data-color="#ff78cb" style="background:#ff78cb;"></div>
                <div class="label-color" data-color="#344563" style="background:#344563;"></div>
            </div>
            <div class="modal-section">
                <div class="modal-section-header">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                        <line x1="3" y1="6" x2="21" y2="6" />
                        <line x1="3" y1="12" x2="15" y2="12" />
                        <line x1="3" y1="18" x2="18" y2="18" />
                    </svg>
                    <h3>Description</h3>
                    <div class="desc-mode-toggle">
                        <button class="btn-toggle active" id="btnEdit">Edit</button>
                        <button class="btn-toggle" id="btnPreview">Preview</button>
                    </div>
                </div>
                <textarea class="modal-description" id="modalDescription"
                    placeholder="Add a detailed description using Markdown..."></textarea>
                <div class="modal-preview markdown-body" id="modalPreview" style="display:none;"></div>
            </div>
            <div class="modal-section">
                <div class="modal-section-header">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                        <path
                            d="M12 2v4m0 12v4M4.93 4.93l2.83 2.83m8.48 8.48l2.83 2.83M2 12h4m12 0h4M4.93 19.07l2.83-2.83m8.48-8.48l2.83-2.83" />
                    </svg>
                    <h3>Move Card</h3>
                </div>
                <select class="modal-select" id="modalMoveSelect"></select>
            </div>
            <div class="modal-section modal-comments-section">
                <div class="modal-section-header">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
                    </svg>
                    <h3>Comments</h3>
                </div>
                <div class="comments-list" id="commentsList"></div>
                <div class="comment-form">
                    <input type="text" class="comment-author-input" id="commentAuthor" placeholder="Your name...">
                    <textarea class="comment-text-input" id="commentText" placeholder="Write a comment..."></textarea>
                    <div class="comment-form-actions">
                        <button class="btn-add-comment" id="addCommentBtn">Add Comment</button>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-save" id="modalSave">Save Changes</button>
                <button class="btn-delete" id="modalDelete">Delete Card</button>
            </div>
        </div>
    </div>

    <!-- Column Rename Modal -->
    <div class="modal-overlay" id="renameOverlay" style="display:none;">
        <div class="modal modal-small">
            <button class="modal-close" id="renameClose">&times;</button>
            <h2 style="margin:0 0 16px;">Rename List</h2>
            <input type="text" class="modal-title-input" id="renameInput" placeholder="List name...">
            <div class="modal-footer" style="margin-top:16px;">
                <button class="btn-save" id="renameSave">Save</button>
            </div>
        </div>
    </div>

    <!-- Add Column Modal -->
    <div class="modal-overlay" id="addColumnOverlay" style="display:none;">
        <div class="modal modal-small">
            <button class="modal-close" id="addColumnClose">&times;</button>
            <div class="modal-header" style="padding-right:36px;">
                <svg class="modal-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    width="20" height="20">
                    <rect x="3" y="3" width="18" height="18" rx="2" />
                    <line x1="12" y1="8" x2="12" y2="16" />
                    <line x1="8" y1="12" x2="16" y2="12" />
                </svg>
                <h2 style="margin:0;font-size:18px;">Add New List</h2>
            </div>
            <input type="text" class="modal-title-input" id="addColumnInput" placeholder="Enter list name..."
                style="margin-top:16px;">
            <div class="modal-footer" style="margin-top:16px;">
                <button class="btn-save" id="addColumnSave">Add List</button>
                <button class="btn-delete" id="addColumnCancel"
                    style="border:none;color:var(--text-secondary);">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Settings Panel -->
    <div class="modal-overlay" id="settingsOverlay" style="display:none;">
        <div class="modal modal-small">
            <button class="modal-close" id="settingsClose">&times;</button>
            <h2 style="margin:0 0 16px;">Settings</h2>
            
            <div class="settings-section">
                <label class="settings-label">Board Background</label>
                <div class="settings-bg-options">
                    <button class="bg-option" data-bg="#0079bf" style="background:#0079bf;"></button>
                    <button class="bg-option" data-bg="#d29034" style="background:#d29034;"></button>
                    <button class="bg-option" data-bg="#519839" style="background:#519839;"></button>
                    <button class="bg-option" data-bg="#b04632" style="background:#b04632;"></button>
                    <button class="bg-option" data-bg="#89609e" style="background:#89609e;"></button>
                    <button class="bg-option" data-bg="#17394d" style="background:#17394d;"></button>
                </div>
                <div class="settings-upload">
                    <label for="bgUpload" class="btn-upload">Upload Photo...</label>
                    <input type="file" id="bgUpload" accept="image/*" style="display:none;">
                </div>
            </div>

            <div class="settings-section">
                <label class="settings-label">Board Name</label>
                <input type="text" class="modal-title-input" id="boardNameInput" placeholder="Board name...">
            </div>
            
            <div class="modal-footer" style="margin-top:16px;">
                <button class="btn-save" id="settingsSave">Save</button>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>

</html>